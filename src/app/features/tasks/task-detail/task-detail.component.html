<div class="task-detail-container">
  <!-- Service Unavailable -->
  <app-service-unavailable 
    *ngIf="serviceUnavailable && !isLoading"
    [message]="errorMessage"
    (retry)="loadTask(task?.id || '')"
  ></app-service-unavailable>

  <div class="loading" *ngIf="isLoading">
    <ng-icon name="heroArrowPath" size="32" class="spin"></ng-icon>
    <p>Carregando tarefa...</p>
  </div>

  <div class="detail-content" *ngIf="task && !isLoading && !serviceUnavailable">
    <div class="header">
      <div class="header-content">
        <h1>{{ task.title }}</h1>
        <div class="header-actions">
          <button type="button" class="btn-edit" (click)="editTask()">
            <ng-icon name="heroPencilSquare" size="18"></ng-icon>
            Editar
          </button>
          <button class="btn-delete" (click)="deleteTask()">
            <ng-icon name="heroTrash" size="18"></ng-icon>
            Excluir
          </button>
          <button type="button" class="btn-back" (click)="goBack()">
            <ng-icon name="heroArrowLeft" size="18"></ng-icon>
            Voltar
          </button>
        </div>
      </div>
    </div>

    <div class="detail-card">
      <!-- Status e Prioridade -->
      <div class="badges-section">
        <div class="badge-item">
          <span class="badge-label">Status:</span>
          <span class="badge" [ngClass]="getStatusClass(task.status)">
            {{ getStatusLabel(task.status) }}
          </span>
        </div>
        <div class="badge-item">
          <span class="badge-label">Prioridade:</span>
          <span class="badge" [ngClass]="getPriorityClass(task.priority)">
            {{ getPriorityLabel(task.priority) }}
          </span>
        </div>
      </div>

      <div class="info-section">
        <h3>
          <ng-icon name="heroDocumentText" size="20"></ng-icon>
          Descrição
        </h3>
        <p class="description">{{ task.description || 'Sem descrição' }}</p>
      </div>

      <div class="info-section">
        <h3>
          <ng-icon name="heroFolderOpen" size="20"></ng-icon>
          Projeto
        </h3>
        <div class="project-info">
          <div class="info-item">
            <ng-icon name="heroFolderOpen" size="20"></ng-icon>
            <div class="info-content">
              <span class="info-label">Nome do Projeto</span>
              <span class="info-value">{{ task.project.name }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="info-section">
        <h3>
          <ng-icon name="heroUser" size="20"></ng-icon>
          Responsável
        </h3>
        <div class="assignee-info">
          <div class="info-item">
            <ng-icon name="heroUser" size="20"></ng-icon>
            <div class="info-content">
              <span class="info-label">Nome</span>
              <span class="info-value">{{ task.assignee.name }}</span>
            </div>
          </div>
          <div class="info-item">
            <ng-icon name="heroUser" size="20"></ng-icon>
            <div class="info-content">
              <span class="info-label">Email</span>
              <span class="info-value">{{ task.assignee.email }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="info-section">
        <h3>
          <ng-icon name="heroCalendar" size="20"></ng-icon>
          Datas
        </h3>
        <div class="dates-grid">
          <div class="info-item">
            <ng-icon name="heroCalendar" size="20"></ng-icon>
            <div class="info-content">
              <span class="info-label">Data de Vencimento</span>
              <span class="info-value">{{ task.dueDate | date: 'dd/MM/yyyy' }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div class="error-alert" *ngIf="errorMessage && !serviceUnavailable">
        <ng-icon name="heroExclamationCircle" size="20"></ng-icon>
        {{ errorMessage }}
      </div>
    </div>
  </div>

  <!-- Not Found -->
  <div class="not-found" *ngIf="!task && !isLoading && !serviceUnavailable">
    <ng-icon name="heroXCircle" size="64"></ng-icon>
    <h2>Tarefa não encontrada</h2>
    <p>A tarefa que você está procurando não existe ou foi removida.</p>
    <button class="btn-back" routerLink="/tasks">
      <ng-icon name="heroArrowLeft" size="18"></ng-icon>
      Voltar para Tarefas
    </button>
  </div>
</div>
